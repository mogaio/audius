(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{113:function(e,t,n){},114:function(e,t,n){},194:function(e,t,n){"use strict";var r=n(113);n.n(r).a},196:function(e,t,n){"use strict";var r=n(114);n.n(r).a},350:function(e,t,n){"use strict";n.r(t);var r=n(4),s=n(0),a=n(1),i=n(26),o={"":["<em>","</em>"],_:["<strong>","</strong>"],"\n":["<br />"]," ":["<br />"],"-":["<hr />"]};function c(e){return e.replace(RegExp("^"+(e.match(/^(\t| )+/)||"")[0],"gm"),"")}function l(e){return(e+"").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var u=function e(t){var n,r,s,a,i,u=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^```(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:\!\[([^\]]*?)\]\(([^\)]+?)\))|(\[)|(\](?:\(([^\)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(\-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,3})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*])/gm,d=[],m="",h=0,g={};function f(e){var t=o[e.replace(/\*/g,"_")[1]||""],n=d[d.length-1]==e;return t?t[1]?(d[n?"pop":"push"](e),t[0|n]):t[0]:e}function v(){for(var e="";d.length;)e+=f(d[d.length-1]);return e}for(t=t.replace(/^\[(.+?)\]:\s*(.+)$/gm,function(e,t,n){return g[t.toLowerCase()]=n,""}).replace(/^\n+|\n+$/g,"");s=u.exec(t);)r=t.substring(h,s.index),h=u.lastIndex,n=s[0],r.match(/[^\\](\\\\)*\\$/)||(s[3]||s[4]?n='<pre class="code '+(s[4]?"poetry":s[2].toLowerCase())+'">'+c(l(s[3]||s[4]).replace(/^\n+|\n+$/g,""))+"</pre>":s[6]?((i=s[6]).match(/\./)&&(s[5]=s[5].replace(/^\d+/gm,"")),a=e(c(s[5].replace(/^\s*[>*+.-]/gm,""))),">"===i?i="blockquote":(i=i.match(/\./)?"ol":"ul",a=a.replace(/^(.*)(\n|$)/gm,"<li>$1</li>")),n="<"+i+">"+a+"</"+i+">"):s[8]?n='<img src="'+l(s[8])+'" alt="'+l(s[7])+'">':s[10]?(m=m.replace("<a>",'<a href="'+l(s[11]||g[r.toLowerCase()])+'">'),n=v()+"</a>"):s[9]?n="<a>":s[12]||s[14]?n="<"+(i="h"+(s[14]?s[14].length:"="===s[13][0]?1:2))+">"+e(s[12]||s[15])+"</"+i+">":s[16]?n="<code>"+l(s[16])+"</code>":(s[17]||s[1])&&(n=f(s[17]||"--"))),m+=r,m+=n;return(m+t.substring(h)+v()).trim()};function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m={props:{video:Object,isAuthor:Boolean,isAdmin:Boolean,membersIndex:Object},methods:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){d(e,t,n[t])})}return e}({},Object(s.b)(["matrixRedact"]),{_snarkdown:function(e){return u(e)},urlify:function(e){return Object(a.v)(e)}}),computed:{event:function(){return this.video},sender:function(){var e=this.event.sender;return this.membersIndex[e]||{name:e,nameColor:""}},_createdAt:function(){var e=new Date(this.event.createdAt);return"".concat(e.getHours(),":").concat(Object(a.z)(e.getMinutes(),2))},messages:function(){for(var e=this.event,t=[e];e.childEvent;)e=e.childEvent,t.push(e);return t}}},h=(n(194),n(2)),g=Object(h.a)(m,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{staticClass:"matrix-chat-message",class:{"matrix-chat-message--author":e.isAuthor}},[n("div",{staticClass:"matrix-chat-message__container"},[n("div",{staticClass:"matrix-chat-message__header",style:{color:e.sender.nameColor}},[e._v("\n\t\t\t"+e._s(e.sender.name)+"\n\t\t")]),e._v(" "),n("div",{staticClass:"matrix-chat-message__body"},e._l(e.messages,function(t){return n("div",{class:{"matrix-chat-message--sending":"sending"===t.status}},[t.body?n("span",{domProps:{innerHTML:e._s(e.urlify(e._snarkdown(t.body)))}}):e._e(),e._v(" "),t.url?n("div",{staticClass:"matrix-chat-message__image",style:{backgroundImage:"url("+t.url+")"}}):e._e(),e._v(" "),e.isAuthor||e.isAdmin?n("div",{staticClass:"wmp-icon-close matrix-chat-message__delete",attrs:{title:"Delete this message"},on:{click:function(n){e.matrixRedact(t)}}}):e._e()])})),e._v(" "),n("div",{staticClass:"matrix-chat-message__footer",class:{"matrix-chat-message--sending":"sending"===e.messages[e.messages.length-1].status}},[e._v(e._s(e._createdAt))])])])},[],!1,null,null,null);g.options.__file="matrix-chat-message.vue";var f=g.exports;function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){p(e,t,n[t])})}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=null,b=0,x=!1,y=0,w={components:{VideoItem:i.a,ChatMessage:f},data:function(){return{messageText:"",overflow:!1}},beforeUpdate:function(){var e=this.$refs.chat;x=e.scrollHeight-e.scrollTop-e.offsetHeight-100<0},mounted:function(){var e=this,t=this.chatLog[this.currentMediaSource.id]||[];_=t.length&&t[t.length-1].createdAt,b=this.$refs.chat.offsetHeight;var n=this.$refs.chat;r.a.nextTick(function(){e.$refs.chat.scrollTo(0,n.scrollHeight)}),this.$store.watch(function(e){return e.matrix.chatLog},function(){var t=e.chatLog[e.currentMediaSource.id];if(t){var s=t[t.length-1],a=s.createdAt,i=s.sender;_!==a?r.a.nextTick(function(){(x||i===e.credentials.userId)&&(n.scrollTo({behavior:"smooth",top:n.scrollHeight}),b=n.scrollHeight)}):r.a.nextTick(function(){var e=n.scrollHeight,t=e-b;n.scrollTop=t,setTimeout(function(){b=e},200)}),_=a}}),n.addEventListener("wheel",this.scrolled),n.addEventListener("scroll",this.scrolled)},computed:v({},Object(s.e)(["currentMediaSource","currentMedia","isPlaying","paginationIndex","isLoading"]),Object(a.p)("matrix",["chatLog","credentials","membersIndex","sources"]),{_chatLog:function(){return(this.chatLog[this.currentMediaSource.id]||[]).filter(function(e){return!e.parentEvent})},_isLoading:function(){return this.isLoading[this.currentMediaSource.id]}}),methods:v({},Object(s.d)(["setMainLeftTab"]),Object(s.b)(["matrixLoadMore","matrixSendText"]),{scrolled:function(e){0===this.$refs.chat.scrollTop&&this.matrixLoadMore(this.currentMediaSource.id)},send:function(e){e.preventDefault(),this.messageText&&(this.matrixSendText({roomId:this.currentMediaSource.id,message:this.messageText.trim()}),this.messageText="",this.overflow=!1)},checkWidth:function(e){this.$refs.message.offsetHeight-this.$refs.message.scrollHeight<0?(this.overflow||(y=this.$refs.message.value.length),this.overflow=!0):this.$refs.message.value.length<y&&(this.overflow=!1,y=this.$refs.message.value.length)}})},O=(n(196),Object(h.a)(w,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"matrix-chat"},[n("div",{ref:"chat",staticClass:"play-list media-list"},[e._chatLog&&e._chatLog.length?e._e():n("div",{staticClass:"play-list__greeting"},[e._v("\n\t\t\tNothing found. Click load more or add from search or playlists.\n\t\t")]),e._v(" "),n("div",{staticClass:"play-list__load-more",on:{click:function(t){e.matrixLoadMore(e.currentMediaSource.id)}}},[e._v("\n\t\t\t… load more (Page "+e._s(e.paginationIndex[e.currentMediaSource.id]||0)+")\n\t\t\t"),n("div",{directives:[{name:"show",rawName:"v-show",value:e._isLoading,expression:"_isLoading"}],staticClass:"loader"})]),e._v(" "),n("ul",{ref:"list"},e._l(e._chatLog,function(t,r){return n("text"===t.type?"chat-message":"video-item",{key:r,tag:"component",attrs:{isAuthor:t.sender===e.credentials.userId,isAdmin:e.sources[e.currentMediaSource.id].isAdmin||t.sender===e.credentials.userId,video:t,membersIndex:e.membersIndex,enableDelete:e.sources[e.currentMediaSource.id].isAdmin||t.sender===e.credentials.userId,isPlaying:"text"!==t.type&&e.isPlaying&&e.currentMedia.id==t.id}})}))]),e._v(" "),n("div",{staticClass:"matrix-chat__footer",class:{"matrix-chat--overflow":e.overflow}},[n("span",{staticClass:"wmp-icon-speaker_notes_off matrix-chat__off",on:{click:function(t){e.setMainLeftTab("playList")}}}),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.messageText,expression:"messageText"}],ref:"message",attrs:{rows:"1",placeholder:"… your message"},domProps:{value:e.messageText},on:{keyup:[e.checkWidth,function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.send(t):null}],input:function(t){t.target.composing||(e.messageText=t.target.value)}}}),e._v(" "),n("span",{staticClass:"wmp-icon-send",on:{click:e.send}})])])},[],!1,null,null,null));O.options.__file="matrix-chat.vue";t.default=O.exports}}]);